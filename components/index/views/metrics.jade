div.container
  div.row(ng-hide="loaded")
    div.col-md-12
      img(src="img/loader.gif", style="margin-top: 15px; margin-right: 15px; float: left;")
      h2 Loading JIRAs...
  div.row(ng-show="loaded")
    div.col-md-12
      h3 Who's in this Week?
      img.img-thumbnail(ng-repeat="person in stat.people", src="{{person.avatarUrls.48x48}}", title="{{person.displayName}}")
      br
      br
    div.col-md-12
        .form-group.pull-right
          label(for="chartTypeButton", style="margin-right: 10px;") Show as:
          button.btn.btn-primary(type="button", id="chartTypeButton", ng-model="isBarchart", ng-change="toggleBarChart()", btn-checkbox)
            {{isBarchart ? 'Line Chart' : 'Bar chart'}}
    div.col-md-12
      h3 Throughput vs People vs Magnitude
      nvd3(options='options', data='data.throughputPeople')
      br
      br
    div.col-md-12
      h3 Predictability vs Productivity vs Velocity
      nvd3(options='options', data='data.predictabilityProductivity')
      br
      br
      b Productivity
      = " = Number of "
      strong issues/week
      = " normalised by the number of "
      b people (High = good)
      br
      b Predictability
      = " = Coefficient of Variance - StdDev of throughput / Mean of throughput "
      b (Low = good)
      br
      b Velocity
      = " = Number of "
      strong points/week
      = " normalised by the number of "
      b people (High = good)
      br
      br
  div.row-fluid(ng-show="loaded")
    div.col-md-12
      div.table-responsive
        table.table.table-striped.table-bordered
          thead
            tr
              th Period Ending
              th Throughput
              th People
              th Total/Average/Std Dev
              th Productivity
              th Predictability
              th Show People
              th Issue Count
              th Bug Count
            tbody
              tr(ng-repeat="stat in stats | orderBy:'i':true")
                td {{ stat.week }}
                td
                  throughput(id="{{stat.identifier}}", ng-attr-width="80", ng-attr-height="50")
                td {{ stat.people.length }}
                td {{ stat.total }} / {{ stat.average}} / {{ stat.stddev }}
                td {{ stat.productivity }}
                td {{ stat.predictability }}
                td
                  div.col-md-2
                    button.btn.btn-default.btn-small(ng-click="isCollapsed = !isCollapsed") People
                  div.col-md-10(ng-show="isCollapsed")
                    br
                    br
                    h5 {{stat.people.length}} People
                    img.img-thumbnail(ng-repeat="person in stat.people", src="{{person.avatarUrls.48x48}}", title="{{person.displayName}}")
                td {{ stat.issueCount }}
                td {{ stat.bugCount }}

  div.row-fluid(ng-show="loaded")
    div.col-md-2
      button.btn.btn-default.btn-small(ng-click="sourceCollapsed = !sourceCollapsed") Source
    div.col-md-10(ng-show="sourceCollapsed")
      h3 Source Data
      p Number of issues completed each week
      div.table-responsive
        table.table.table-striped.table-bordered
          thead
            tr
              th Start Date
              th Issues Completed
              th Source
            tbody
              tr(ng-repeat="key in weekBuckets | orderBy:'i':true")
                td {{ key.startDate }}
                td {{ key.issues.length }}
                td
                  div.col-md-2
                    button.btn.btn-default.btn-small(ng-click="issueCollapsed = !issueCollapsed") Issues
                  div.col-md-10
                    div.table-responsive(ng-show="issueCollapsed")
                      table.table.table-striped.table-bordered.table-hover
                        thead
                          tr
                            th Key
                            th Issue Type
                          tbody
                            tr(ng-repeat="issue in key.issues")
                              td
                                a(href='http://jira.is3.c4isr.adi-limited.com:8080/browse/{{ issue.key }}') {{ issue.key }}
                              td {{ issue.fields.issuetype.name }}